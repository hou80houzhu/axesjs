/*!
 * @packet opensite.pc.main; 
 * @template opensite.pc.template.tmp;
 * @css opensite.pc.style.new;
 * @css opensite.pc.style.font;
 * @json opensite.pc.data.menu;
 * @js lib.prism;
 * @css lib.prism;
 */Module({name:"menu",extend:"view",className:"menu",template:module.getTemplate("@tmp","menu"),init:function(){this.render(module.getJson("@menu").data)},find_item:function(t){var i=this;t.click(function(){$(this).parent().children().each(function(){$(this).removeClass("active")}),$(this).addClass("active"),i.parentView.togglePage($(this).attr("pagename"));var t=$(this).index();0===t?(i.parentView.hideLeft(),i.parentView.showRight()):t===$(this).parent().children().length-1?(i.parentView.showLeft(),i.parentView.hideRight()):(i.parentView.showLeft(),i.parentView.showRight())})},nextPage:function(){this.dom.find(".active").prev().click()},prevPage:function(){this.dom.find(".active").next().click()},firstClick:function(){this.finders().eq(0).click()},gotoPage:function(t){var i=null;this.finders("item").each(function(){var e=$(this).attr("pagename");return e===t?(i=$(this),!1):void 0}),i&&i.click()}}),Module({name:"container",extend:"viewgroup",className:"container",option:{offset:30},layout:module.getTemplate("@tmp","container"),init:function(){var t=this;this._running=!1,this._currentpage="";var i=[{pagename:"about",width:400,type:"@.aboutpage"},{pagename:"start",width:600,type:"@.page"},{pagename:"todo",width:800,type:"@.todolistpage"},{pagename:"demo",width:300,type:"@.page"},{pagename:"api",width:300,type:"@.apipage"},{pagename:"tools",width:400,type:"@.page"},{pagename:"question",width:700,type:"@.page"},{pagename:"end",width:$(window).width()-700-260,type:"@.page"}];t.addChild({type:"@.menu"});for(var e=0;e<i.length;e++){var n=t.addChild({type:i[e].type,option:i[e],container:t.dom.children(0)});e===i.length-1&&n.done(function(t){t.dom.children(0).children(0).css("overflow","auto"),this.getChildAt(0).firstClick()})}},find_left:function(t){var i=this;t.click(function(){i.getChildAt(0).nextPage()})},find_right:function(t){var i=this;t.click(function(){i.getChildAt(0).prevPage()})},togglePage:function(t){if(this._running===!1&&t!==this._currentpage){this._running=!0;var i=this,e=!1,n=0;this.children.forEach(function(o,a){o.typeOf("@.page")&&(o.setMask(),e||(o.option.pagename===t?(e=!0,o.removeMask(),i._currentpage=t):n+=o.width()))}),this.dom.children(0).scrollingLeft(n,400).done(function(){i._running=!1})}},showLeft:function(){this.finders("left").removeClass("hide")},hideLeft:function(){this.finders("left").addClass("hide")},showRight:function(){this.finders("right").removeClass("hide")},hideRight:function(){this.finders("right").addClass("hide")},event_togglePage:function(t){this.getChildAt(0).gotoPage(t.data)}}),Module({name:"page",extend:"viewgroup",className:"page",option:{width:700,title:"",pagename:"",path:"",id:""},layout:module.getTemplate("@tmp","page"),find_btn:function(t){var i=this;t.click(function(){i.dispatchEvent($(this).attr("action"),i)})},event_close:function(){this.dispatchEvent("closepage",this)},init:function(){var t=this;this.iscontent=!1,this.dom.width(this.option.width),""===this.option.path&&(this.option.path=basePath+"pages/"+this.option.pagename+".html"),this.getContent(this.option.path),$(window).bind("resize",function(){t.setScroll()}),this.dom.click(function(){t.dispatchEvent("togglePage",t.option.pagename)})},width:function(){return this.option.width},getContent:function(t){var i=this;$.loader().text(t,function(t){var e=t.match(/<body>[\S\s]*?<\/body>/);e&&(t="<div class='content-p-code'>"+e[0].substring(6,e[0].length-7)+"</div>"),i.finders("content").html(t),i.setScroll(),i.setScrollEvent(),i.iscontent=!0,i.scrollTop(i.option.id),i.delegate(),i.dispatchEvent("contentdone")})},setMask:function(){this.dom.addClass("active")},removeMask:function(){this.dom.removeClass("active"),this.iscontent&&this.setScroll()},setScroll:function(){var t=this.dom.height(),i=this.finders("content").height(),e=this;i>=t?e.dom.removeClass("hidebar"):e.dom.addClass("hidebar")},setScrollEvent:function(){},refresh:function(t,i){0===arguments.length?t=basePath+"pages/"+this.option.pagename+".html":this.option.path=t,this.finders("content").html("<div class='page-body-content-loading'><div class='a fa-spin'><i class='fa fa-repeat fa-spin'></i></div> Loading...</div>"),this.option.id=i,this.getContent(this.option.path)},scrollTop:function(t){if($.is.isNumber(t)){var i=this.dom.find("h2").eq(t);i.length>0&&this.finders("content").parent().scrollingTop(i.get(0).offsetTop)}},checkPath:function(t){return this.option.path===t}}),Module({name:"aboutpage",extend:"@.page",init:function(){this.superClass("init"),$.loader().js("https://buttons.github.io/buttons.js",null,null,{id:"github-bjs"})}}),Module({name:"todolistpage",extend:"@.page",init:function(){this.superClass("init")},event_contentdone:function(){this.dom.find(".demoshow").hide(),this.addChild({type:"demo.todolist.todolist.todolist",container:this.dom.find(".demoshow")}).done(function(){this.dom.find(".demoshowloading").remove(),this.dom.find(".demoshow").show()}),this.dom.find(".language-javascript").each(function(){Prism.highlightElement($(this).get(0))}),this.dom.find(".language-scss").each(function(){Prism.highlightElement($(this).get(0))}),this.dom.find(".language-html").each(function(){Prism.highlightElement($(this).get(0))})}}),Module({name:"apipage",extend:"@.page",layout:module.getTemplate("@tmp","apipage"),init:function(){this.option.width=240,this.dom.width(this.option.width),this.addChild({type:"@.page",option:{pagename:"api",width:240,override:{find_link:function(t){var i=this;t.click(function(){i.dispatchEvent("click",{page:$(this).parent(2).dataset("href"),id:$(this).index()})})}}},container:this.finders("left")})},event_click:function(t){var i=basePath+"pages/api/"+t.data.page+".html";1===this.children.length?this.dom.transition().all().done(function(){this.addChild({type:"@.page",option:{pagename:"doc",width:800,path:i,id:t.data.id},container:this.finders("right")}),this.option.width=1040}.bind(this)).scope().width(1040):this.getChildAt(1).checkPath(i)?this.getChildAt(1).scrollTop(t.data.id):this.getChildAt(1).refresh(i,t.data.id),t.stopPropagation()}});